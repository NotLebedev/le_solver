\documentclass[a4paper,12pt,titlepage,finall]{article}

\usepackage[T1,T2A]{fontenc}     % форматы шрифтов
\usepackage[utf8]{inputenc}      % кодировка символов, используемая в данном файле
\usepackage[russian]{babel}      % пакет русификации
\usepackage{tikz}                % для создания иллюстраций
\usepackage{pgfplots}            % для вывода графиков функций
\usepackage{geometry}		     % для настройки размера полей
\usepackage{indentfirst}         % для отступа в первом абзаце секции
\usepackage{amsmath,amsthm,amssymb}
\usepackage{mathtext}
\usepackage{graphicx}
\graphicspath{ {./} }

%Настройка листингов для языка C
\usepackage{xcolor}
\usepackage{listings}

\definecolor{mGreen}{rgb}{0,0.6,0}
\definecolor{mGray}{rgb}{0.5,0.5,0.5}
\definecolor{mPurple}{rgb}{0.58,0,0.82}
\definecolor{backgroundColour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{CStyle}{
    backgroundcolor=\color{backgroundColour},   
    commentstyle=\color{mGreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{mGray},
    stringstyle=\color{mPurple},
    basicstyle=\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=none,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2,
    language=C,
}

\lstdefinestyle{MakeStyle}{
    backgroundcolor=\color{backgroundColour},   
    commentstyle=\color{mGreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{mGray},
    stringstyle=\color{mPurple},
    basicstyle=\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=none,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2,
    language=[gnu] make,
}

% выбираем размер листа А4, все поля ставим по 3см
\geometry{a4paper,left=30mm,top=30mm,bottom=30mm,right=30mm}

\setcounter{secnumdepth}{0}      % отключаем нумерацию секций
%\setcounter{tocdepth}{1}

\usepgfplotslibrary{fillbetween} % для изображения областей на графиках

\begin{document}
\begin{titlepage}
    \begin{center}
	{\small \sc Московский государственный университет \\имени М.~В.~Ломоносова\\
	Факультет вычислительной математики и кибернетики\\}
	\hrulefill
	\vfill
	{\large \bf Компьютерный практикум по учебному курсу}\\
	~\\
	{\Large \bf <<ВВЕДЕНИЕ В ЧИСЛЕННЫЕ МЕТОДЫ>>}\\ 
	~\\
	{\Large \bf ЗАДАНИЕ № 1}\\
	~\\
	{\large \bf ОТЧЕТ}\\
	{\bf о выполненном задании}\\
	{студента 201 учебной группы факультета ВМК МГУ}\\
	{Галустова Артемия Львовича}
    \end{center}
    
    \begin{center}
	\vfill
	{\small гор. Москва\\2020 год}
    \end{center}
\end{titlepage}

\tableofcontents
\newpage

\section{Подвариант 1}
\subsection{Цель работы}

Изучить классический метод Гаусса (а также модифицированный метод Гаусса),
применяемый для решения системы линейных алгебраических уравнений.

\subsection{Постановка задачи}

Дана система уравнений $Ax=f$ порядка $n \times n$ с невырожденной матрицей $A$. Написать
программу, решающую систему линейных алгебраических уравнений заданного
пользователем размера ($n$ – параметр программы) методом Гаусса и методом Гаусса с
выбором главного элемента.

\subsection{Цели и задачи практической работы}

\begin{enumerate}
\item
Решить заданную СЛАУ методом Гаусса и методом Гаусса с выбором главного
элемента;
\item
Вычислить определитель матрицы $det(A)$;
\item
Вычислить обратную матрицу $A^{-1}$;
\item
Определить число обусловленности $МA=||A|| \times ||A^{-1}||$;
\item
Исследовать вопрос вычислительной устойчивости метода Гаусса (при больших
значениях параметра $n$);
\item
Правильность решения СЛАУ подтвердить системой тестов (использован пакет символьных вычислений Wolfaram Mathematica).
\end{enumerate}

\newpage
\subsection{Описание метода решения}
Рассмотрим СЛАУ вида
\begin{align*}
\begin{cases}
a_{11} x_1 + a_{12} x_2 + ... + a_{1n} x_n = f_1\\
a_{21} x_1 + a_{22} x_2 + ... + a_{2n} x_n = f_2\\
...\\
a_{n1} x_1 + a_{n2} x_2 + ... + a_{nn} x_n = f_n\\
\end{cases}
\end{align*}
\par
Которая соответствует матричному представлению $A \times x = f$, где $A = (a_{ij}), f = (f_1, f_2, ... f_n)^T$ и $|A| \neq 0$. Поиск решения методом Гаусса, как с выбором главного элемента, так и без, состоит из двух основных этапов: прямой ход, приведению матрицы к треугольному виду виду; обратный ход, последовательное нахождение $x_n, x_{n - 1}, ... x_1$. Опишем подробнее данные этапы.
\par
Прямой ход метода Гаусса осуществляется следующим образом. В первой строке матрицы системы выбирается либо первый ненулевой, в случае обычного метода Гаусса, либо наибольший по модулю, в случае метода с выбором главного элемента, элемент. Такой ненулевой элемент обязательно найдётся в силу невырожденности матрицы. Затем столбцы расширенной матрицы переставляются так, чтобы выбранный элемент был в первом столбце. Это возможно реализовать явной перестановкой столбцов матрицы и перенумерованием переменных, однако это неэффективно, т.к. требует обмена значений $n$ чисел на каждом шаге. В представленной реализации сохраняется дополнительный массив, указывающий порядок выбора столбцов на каждом шаге прямого хода. Не ограничивая общности, можно считать, что такой элемент находится в первом столбце. Затем из всех последующих строк расширенной матрицы вычитается первая, домноженная на коэффициент $\frac{a_{1k}}{a_{11}}, k = 2 .. n$. Получается система
\begin{equation*}
\left\{
\begin{alignedat}{3}
a_{11} x_1 + &a_{12} x_2 &+ ... + a_{1n} x_n & = f_1\\
           &a'_{22} x_2 &+ ... + a'_{2n} x_n & = f'_2\\
&...&&\\
           &a'_{n2} x_2 &+ ... + a'_{nn} x_n & = f'_n\\
\end{alignedat}
\right.
\end{equation*}
\\
где $a'_{ij} = a_{ij} - a_{i1} \frac{a_{1j}}{a_{11}}, f'_i = f_i - a_{i1} \frac{f_1}{a_{11}}$. Далее указанные преобразования аналогично повторяются для второй, третей и т.д. строк. В итоге по результатам прямого хода получается система с верхнетреугольной матрицей. Т.к. осуществлялись только сложения строк с коэффициентом, то данная система эквивалентна изначальной. Представление в виде системы уравнений:
\begin{equation*}
\left\{
\begin{alignedat}{3}
с_{11} x_1 + & с_{12} x_2 + ... + & c_{1 n-1} x_{n-1} +     & с_{1n} x_n    & = g_1\\
             & c_{22} x_2 + ... + & c_{2 n-1} x_{n-1} +     & с_{2n} x_n    & = g_2\\
&...&&&\\
             &                    & c_{n - 1 n-1} x_{n-1} + & c_{n-1 n} x_n & = g_{n-1}\\
             &                    &                         & c_{nn} x_n    & = g_n\\
\end{alignedat}
\right.
\end{equation*}
\par
Обратный ход метода Гаусса осуществляется над полученной при прямом ходе системой с учётном перестановки столбцов. Корни уравнения находятся в обратном порядке с использованием найденных ранее по формуле $x_k = c^{-1}_{kk} (g_k - c_{k k+1}x_{k+1} - c_{k k+2}x_{k+2} + ... + - c_{k n}x_n)$. Заметим, что $c_{kk} \neq 0$ т.к. выбирается ненулевым во время прямого хода.

\subsection{Вычисление определителя матрицы}
Воспользовавшись прямым ходом метода Гаусса, описанным выше, можно получить верхнетреугольную матрицу с точностью до перестановки столбцов. Тогда для вычисления определителя достаточно перемножить элементы соответствующие диагональным и домножить на $(-1)^{N(p)}$, где $N(p)$ -- число инверсий в перестановке порядка столбцов.
\subsection{Вычисление обратной матрицы}
Обратную матрицу вычислим по методу Гаусса-Жордана. В приведенном выше методе Гаусса (без выбора главного элемента) сделаем изменение. В случае, если диагональный элемент 0 будем обменивать строки а не столбцы и обменивать в явном виде. Также на каждом шаге будем нормализовать текущую строку, т.е. делить строку на диагональный элемент. Тогда применение к расширенной матрице $(A|I)$ метод Гаусса с указанными модификациями дважды,  в прямом и "обратном" направлении, получим матрицу $(I|A^{-1})$, правая часть этой расширенной матрицы и содержит обратную матрицу.
\subsection{Вычисление числа обусловленности}
Для вычисления числа обусловленности воспользуемся нормой $||A||_l = \max\limits_{1 \leq i \leq n} \sum\limits_{j=1}^n |a_{ij}|$. Тогда число обусловленности СЛАУ $M_A=||A|| \cdot ||A^{-1}||$, где обратную матрицу можно вычислить приведённым выше методом.
\end{document}